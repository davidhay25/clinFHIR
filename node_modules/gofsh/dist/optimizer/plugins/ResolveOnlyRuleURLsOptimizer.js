"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fsh_sushi_1 = require("fsh-sushi");
const utils_1 = require("../utils");
const exportable_1 = require("../../exportable");
const FISHER_TYPES = [
    fsh_sushi_1.utils.Type.Resource,
    fsh_sushi_1.utils.Type.Type,
    fsh_sushi_1.utils.Type.Profile,
    fsh_sushi_1.utils.Type.Extension
];
exports.default = {
    name: 'resolve_only_rule_urls',
    description: 'Replace URLs in "only" rules with their names or aliases',
    optimize(pkg, fisher, options = {}) {
        [...pkg.profiles, ...pkg.extensions].forEach(sd => {
            sd.rules.forEach(rule => {
                if (rule instanceof exportable_1.ExportableOnlyRule) {
                    rule.types.forEach(onlyRuleType => {
                        var _a;
                        onlyRuleType.type = (0, utils_1.optimizeURL)(onlyRuleType.type, pkg.aliases, FISHER_TYPES, fisher, (_a = options.alias) !== null && _a !== void 0 ? _a : true);
                    });
                }
            });
        });
    }
};
//# sourceMappingURL=ResolveOnlyRuleURLsOptimizer.js.map