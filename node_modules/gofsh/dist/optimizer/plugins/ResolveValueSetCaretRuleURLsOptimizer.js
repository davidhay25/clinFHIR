"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fsh_sushi_1 = require("fsh-sushi");
const utils_1 = require("../utils");
const exportable_1 = require("../../exportable");
exports.default = {
    name: 'resolve_value_set_caret_rule_urls',
    description: 'Replace URLs in value set caret rules with their names or aliases',
    runAfter: ['resolve_value_set_component_rule_urls'],
    optimize(pkg, fisher, options = {}) {
        pkg.valueSets.forEach(vs => {
            vs.rules.forEach(rule => {
                var _a;
                if (rule instanceof exportable_1.ExportableCaretValueRule && rule.pathArray.length > 0) {
                    const [system, ...code] = rule.pathArray[0].split('#');
                    const resolvedSystem = (0, utils_1.optimizeURL)(system, pkg.aliases, [fsh_sushi_1.utils.Type.CodeSystem], fisher, (_a = options.alias) !== null && _a !== void 0 ? _a : true);
                    rule.pathArray[0] = [resolvedSystem, code.join('#')].join('#');
                }
            });
        });
    }
};
//# sourceMappingURL=ResolveValueSetCaretRuleURLsOptimizer.js.map